{ pkgs, lib, stdenv, buildGoModule, fetchFromGitHub, ... }:

buildGoModule rec {

  pname = "horusec";
  version = "2.8.0";

  src = fetchFromGitHub {
    owner = "ZupIT";
    repo = "horusec";
    rev = "873d4104a6aa89be8f86d93db8e416909d9add87";
    sha256 = "sha256-icuwxA1cgmd22UoAEQ2fg128I2WN12bo04pUfb7o3DE=";
  };

  modSha256 = "sha256-iFZTn1yokMhXossXvKqsBIgLC5qq6gSJgJOpGW07tCU=";
  vendorHash = "sha256-iFZTn1yokMhXossXvKqsBIgLC5qq6gSJgJOpGW07tCU=";
  subPackages = [ "./cmd/app/" ];

  postInstall = ''
    mv $out/bin/app $out/bin/horusec
  '';

}


